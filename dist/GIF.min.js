+function(){function t(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||57!==t[e++]||97!==t[e++])throw"Invalid GIF 89a header.";{var n=t[e++]|t[e++]<<8,i=t[e++]|t[e++]<<8,a=t[e++],o=a>>7,f=7&a,u=1<<f+1;t[e++]}t[e++];var c=null;o&&(c=e,e+=3*u);var l=null,s=!0,h=[],v=0,w=null,y=0,l=null;for(this.width=n,this.height=i;s&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,l=t[e++]|t[e++]<<8,e++;
else for(e+=12;;){var d=t[e++];if(0===d)break;e+=d}break;case 249:if(4!==t[e++]||0!==t[e+4])throw"Invalid graphics extension block.";var g=t[e++];v=t[e++]|t[e++]<<8,w=t[e++],0===(1&g)&&(w=null),y=g>>2&7,e++;break;case 254:for(;;){var d=t[e++];if(0===d)break;e+=d}break;default:throw"Unknown graphic control label: 0x"+t[e-1].toString(16)}break;case 44:var B=t[e++]|t[e++]<<8,p=t[e++]|t[e++]<<8,m=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,F=t[e++],k=F>>7,x=F>>6&1,I=7&F,A=1<<I+1,_=c,G=!1;if(k){var G=!0;_=e,e+=3*A
}var E=e;for(e++;;){var d=t[e++];if(0===d)break;e+=d}h.push({x:B,y:p,width:m,height:b,has_local_palette:G,palette_offset:_,data_offset:E,data_length:e-E,transparent_index:w,interlaced:!!x,delay:v,disposal:y});break;case 59:s=!1;break;default:throw"Unknown gif block: 0x"+t[e-1].toString(16)}this.numFrames=function(){return h.length},this.frameInfo=function(t){if(0>t||t>=h.length)throw"Frame index out of range.";return h[t]},this.decodeAndBlitFrameBGRA=function(e,i){var a=this.frameInfo(e),o=a.width*a.height,f=new Uint8Array(o);
r(t,a.data_offset,f,o);var u=a.palette_offset,c=a.transparent_index;null===c&&(c=256);var l=a.width,s=n-l,h=l,v=4*(a.y*n+a.x),w=4*((a.y+a.height)*n+a.x),y=v,d=4*s;a.interlaced===!0&&(d+=4*(l+s)*7);for(var g=8,B=0,p=f.length;p>B;++B){var m=f[B];if(0===h&&(y+=d,h=l,y>=w&&(d=s+4*(l+s)*(g-1),y=v+(l+s)*(g<<1),g>>=1)),m===c)y+=4;else{var b=t[u+3*m],F=t[u+3*m+1],k=t[u+3*m+2];i[y++]=k,i[y++]=F,i[y++]=b,i[y++]=255}--h}},this.decodeAndBlitFrameRGBA=function(e,i){var a=this.frameInfo(e),o=a.width*a.height,f=new Uint8Array(o);
r(t,a.data_offset,f,o);var u=a.palette_offset,c=a.transparent_index;null===c&&(c=256);var l=a.width,s=n-l,h=l,v=4*(a.y*n+a.x),w=4*((a.y+a.height)*n+a.x),y=v,d=4*s;a.interlaced===!0&&(d+=4*(l+s)*7);for(var g=8,B=0,p=f.length;p>B;++B){var m=f[B];if(0===h&&(y+=d,h=l,y>=w&&(d=s+4*(l+s)*(g-1),y=v+(l+s)*(g<<1),g>>=1)),m===c)y+=4;else{var b=t[u+3*m],F=t[u+3*m+1],k=t[u+3*m+2];i[y++]=b,i[y++]=F,i[y++]=k,i[y++]=255}--h}}}function r(t,r,e,n){for(var i=t[r++],a=1<<i,o=a+1,f=o+1,u=i+1,c=(1<<u)-1,l=0,s=0,h=0,v=t[r++],w=new Int32Array(4096),y=null;;){for(;16>l&&0!==v;)s|=t[r++]<<l,l+=8,1===v?v=t[r++]:--v;
if(u>l)break;var d=s&c;if(s>>=u,l-=u,d!==a){if(d===o)break;for(var g=f>d?d:y,B=0,p=g;p>a;)p=w[p]>>8,++B;var m=p,b=h+B+(g!==d?1:0);if(b>n)return void console.log("Warning, gif stream longer than expected.");e[h++]=m,h+=B;var F=h;for(g!==d&&(e[h++]=m),p=g;B--;)p=w[p],e[--F]=255&p,p>>=8;null!==y&&4096>f&&(w[f++]=y<<8|m,f>=c+1&&12>u&&(++u,c=c<<1|1)),y=d}else f=o+1,u=i+1,c=(1<<u)-1,y=null}return h!==n&&console.log("Warning, gif stream shorter than expected."),e}var e;LZWEncoder=function(){var t,r,e,n,i,a,o,f,u,c,l,s,h={},v=-1,w=12,y=5003,d=w,g=1<<w,B=[],p=[],m=y,b=0,F=!1,k=0,x=0,I=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],A=[],_=h.LZWEncoder=function(i,a,o,f){t=i,r=a,e=o,n=Math.max(2,f)
},G=function(t,r){A[s++]=t,s>=254&&C(r)},E=function(t){U(m),b=c+2,F=!0,W(c,t)},U=function(t){for(var r=0;t>r;++r)B[r]=-1},T=h.compress=function(t,r){var e,n,i,a,h,w,y;for(u=t,F=!1,o=u,f=D(o),c=1<<t-1,l=c+1,b=c+2,s=0,a=S(),y=0,e=m;65536>e;e*=2)++y;y=8-y,w=m,U(w),W(c,r);t:for(;(i=S())!=v;)if(e=(i<<d)+a,n=i<<y^a,B[n]!=e){if(B[n]>=0){h=w-n,0===n&&(h=1);do if((n-=h)<0&&(n+=w),B[n]==e){a=p[n];continue t}while(B[n]>=0)}W(a,r),a=i,g>b?(p[n]=b++,B[n]=e):E(r)}else a=p[n];W(a,r),W(l,r)},C=(h.encode=function(e){e.writeByte(n),i=t*r,a=0,T(n+1,e),e.writeByte(0)
},function(t){s>0&&(t.writeByte(s),t.writeBytes(A,0,s),s=0)}),D=function(t){return(1<<t)-1},S=function(){if(0===i)return v;--i;var t=e[a++];return 255&t},W=function(t,r){for(k&=I[x],x>0?k|=t<<x:k=t,x+=o;x>=8;)G(255&k,r),k>>=8,x-=8;if((b>f||F)&&(F?(f=D(o=u),F=!1):(++o,f=o==d?g:D(o))),t==l){for(;x>0;)G(255&k,r),k>>=8,x-=8;C(r)}};return _.apply(this,arguments),h},NeuQuant=function(){var t,r,e,n,i,a={},o=256,f=499,u=491,c=487,l=503,s=3*l,h=o-1,v=4,w=100,y=16,d=1<<y,g=10,B=10,p=d>>B,m=d<<g-B,b=o>>3,F=6,k=1<<F,x=b*k,I=30,A=10,_=1<<A,G=8,E=1<<G,U=A+G,T=1<<U,C=[],D=[],S=[],W=[],N=a.NeuQuant=function(t,a,f){var u,c;
for(r=t,e=a,n=f,i=new Array(o),u=0;o>u;u++)i[u]=new Array(4),c=i[u],c[0]=c[1]=c[2]=(u<<v+8)/o,S[u]=d/o,D[u]=0},Q=function(){for(var t=[],r=new Array(o),e=0;o>e;e++)r[i[e][3]]=e;for(var n=0,a=0;o>a;a++){var f=r[a];t[n++]=i[f][0],t[n++]=i[f][1],t[n++]=i[f][2]}return t},R=function(){var t,r,e,n,a,f,u,c;for(u=0,c=0,t=0;o>t;t++){for(a=i[t],e=t,n=a[1],r=t+1;o>r;r++)f=i[r],f[1]<n&&(e=r,n=f[1]);if(f=i[e],t!=e&&(r=f[0],f[0]=a[0],a[0]=r,r=f[1],f[1]=a[1],a[1]=r,r=f[2],f[2]=a[2],a[2]=r,r=f[3],f[3]=a[3],a[3]=r),n!=u){for(C[u]=c+t>>1,r=u+1;n>r;r++)C[r]=t;
u=n,c=t}}for(C[u]=c+h>>1,r=u+1;256>r;r++)C[r]=h},L=function(){var i,a,o,h,y,d,g,B,p,m,b,k,A,G;for(s>e&&(n=1),t=30+(n-1)/3,k=r,A=0,G=e,b=e/(3*n),m=b/w|0,B=_,d=x,g=d>>F,1>=g&&(g=0),i=0;g>i;i++)W[i]=B*((g*g-i*i)*E/(g*g));for(p=s>e?3:e%f!==0?3*f:e%u!==0?3*u:e%c!==0?3*c:3*l,i=0;b>i;)if(o=(255&k[A+0])<<v,h=(255&k[A+1])<<v,y=(255&k[A+2])<<v,a=j(o,h,y),Z(B,a,o,h,y),0!==g&&P(g,a,o,h,y),A+=p,A>=G&&(A-=e),i++,0===m&&(m=1),i%m===0)for(B-=B/t,d-=d/I,g=d>>F,1>=g&&(g=0),a=0;g>a;a++)W[a]=B*((g*g-a*a)*E/(g*g))},M=(a.map=function(t,r,e){var n,a,f,u,c,l,s;
for(c=1e3,s=-1,n=C[r],a=n-1;o>n||a>=0;)o>n&&(l=i[n],f=l[1]-r,f>=c?n=o:(n++,0>f&&(f=-f),u=l[0]-t,0>u&&(u=-u),f+=u,c>f&&(u=l[2]-e,0>u&&(u=-u),f+=u,c>f&&(c=f,s=l[3])))),a>=0&&(l=i[a],f=r-l[1],f>=c?a=-1:(a--,0>f&&(f=-f),u=l[0]-t,0>u&&(u=-u),f+=u,c>f&&(u=l[2]-e,0>u&&(u=-u),f+=u,c>f&&(c=f,s=l[3]))));return s},a.process=function(){return L(),M(),R(),Q()},function(){var t;for(t=0;o>t;t++)i[t][0]>>=v,i[t][1]>>=v,i[t][2]>>=v,i[t][3]=t}),P=function(t,r,e,n,a){var f,u,c,l,s,h,v;for(c=r-t,-1>c&&(c=-1),l=r+t,l>o&&(l=o),f=r+1,u=r-1,h=1;l>f||u>c;){if(s=W[h++],l>f){v=i[f++];
try{v[0]-=s*(v[0]-e)/T,v[1]-=s*(v[1]-n)/T,v[2]-=s*(v[2]-a)/T}catch(w){}}if(u>c){v=i[u--];try{v[0]-=s*(v[0]-e)/T,v[1]-=s*(v[1]-n)/T,v[2]-=s*(v[2]-a)/T}catch(w){}}}},Z=function(t,r,e,n,a){var o=i[r];o[0]-=t*(o[0]-e)/_,o[1]-=t*(o[1]-n)/_,o[2]-=t*(o[2]-a)/_},j=function(t,r,e){var n,a,f,u,c,l,s,h,w,d;for(h=~(1<<31),w=h,l=-1,s=l,n=0;o>n;n++)d=i[n],a=d[0]-t,0>a&&(a=-a),f=d[1]-r,0>f&&(f=-f),a+=f,f=d[2]-e,0>f&&(f=-f),a+=f,h>a&&(h=a,l=n),u=a-(D[n]>>y-v),w>u&&(w=u,s=n),c=S[n]>>B,S[n]-=c,D[n]+=c<<g;return S[l]+=p,D[l]-=m,s
};return N.apply(this,arguments),a},GIFEncoder=function(){function t(){this.bin=[]}for(var r=0,e={};256>r;r++)e[r]=String.fromCharCode(r);t.prototype.getData=function(){for(var t="",r=this.bin.length,n=0;r>n;n++)t+=e[this.bin[n]];return t},t.prototype.writeByte=function(t){this.bin.push(t)},t.prototype.writeUTFBytes=function(t){for(var r=t.length,e=0;r>e;e++)this.writeByte(t.charCodeAt(e))},t.prototype.writeBytes=function(t,r,e){for(var n=e||t.length,i=r||0;n>i;i++)this.writeByte(t[i])};{var n,i,a,o,f,u,c,l,s,h={},v=null,w=-1,y=0,d=!1,g=[],B=7,p=-1,m=!1,b=!0,F=!1,k=10,x="Generated by jsgif (https://github.com/antimatter15/jsgif/)",I=(h.setDelay=function(t){y=Math.round(t/10)
},h.setDispose=function(t){t>=0&&(p=t)},h.setRepeat=function(t){t>=0&&(w=t)},h.setTransparent=function(t){v=t},h.setComment=function(t){x=t},h.addFrame=function(t,r){if(null===t||!d||null===o)throw new Error("Please call start method before calling addFrame");var e=!0;try{r?f=t:(f=t.getImageData(0,0,t.canvas.width,t.canvas.height).data,F||A(t.canvas.width,t.canvas.height)),E(),_(),b&&(D(),W(),w>=0&&S()),U(),""!==x&&T(),C(),b||W(),Q(),b=!1}catch(n){e=!1}return e},h.finish=function(){if(!d)return!1;
var t=!0;d=!1;try{o.writeByte(59)}catch(r){t=!1}return t},function(){a=0,f=null,u=null,c=null,s=null,m=!1,b=!0}),A=(h.setFrameRate=function(t){15!=t&&(y=Math.round(100/t))},h.setQuality=function(t){1>t&&(t=1),k=t},h.setSize=function(t,r){(!d||b)&&(n=t,i=r,1>n&&(n=320),1>i&&(i=240),F=!0)}),_=(h.start=function(){I();var r=!0;m=!1,o=new t;try{o.writeUTFBytes("GIF89a")}catch(e){r=!1}return d=r},h.cont=function(){I();var r=!0;return m=!1,o=new t,d=r},function(){var t=u.length,r=t/3;c=[];var e=new NeuQuant(u,t,k);
s=e.process();for(var n=0,i=0;r>i;i++){var o=e.map(255&u[n++],255&u[n++],255&u[n++]);g[o]=!0,c[i]=o}u=null,l=8,B=7,null!==v&&(a=G(v))}),G=function(t){if(null===s)return-1;for(var r=(16711680&t)>>16,e=(65280&t)>>8,n=255&t,i=0,a=16777216,o=s.length,f=0;o>f;){var u=r-(255&s[f++]),c=e-(255&s[f++]),l=n-(255&s[f]),h=u*u+c*c+l*l,v=f/3;g[v]&&a>h&&(a=h,i=v),f++}return i},E=function(){var t=n,r=i;u=[];for(var e=f,a=0,o=0;r>o;o++)for(var c=0;t>c;c++){var l=o*t*4+4*c;u[a++]=e[l],u[a++]=e[l+1],u[a++]=e[l+2]}},U=function(){o.writeByte(33),o.writeByte(249),o.writeByte(4);
var t,r;null===v?(t=0,r=0):(t=1,r=2),p>=0&&(r=7&p),r<<=2,o.writeByte(0|r|0|t),N(y),o.writeByte(a),o.writeByte(0)},T=function(){o.writeByte(33),o.writeByte(254),o.writeByte(x.length),o.writeUTFBytes(x),o.writeByte(0)},C=function(){o.writeByte(44),N(0),N(0),N(n),N(i),o.writeByte(b?0:128|B)},D=function(){N(n),N(i),o.writeByte(240|B),o.writeByte(0),o.writeByte(0)},S=function(){o.writeByte(33),o.writeByte(255),o.writeByte(11),o.writeUTFBytes("NETSCAPE2.0"),o.writeByte(3),o.writeByte(1),N(w),o.writeByte(0)
},W=function(){o.writeBytes(s);for(var t=768-s.length,r=0;t>r;r++)o.writeByte(0)},N=function(t){o.writeByte(255&t),o.writeByte(t>>8&255)},Q=function(){var t=new LZWEncoder(n,i,c,l);t.encode(o)};h.stream=function(){return o},h.setProperties=function(t,r){d=t,b=r}}return h},window.GIF?e=window.GIF:(e={},window.GIF=e),e.Encoder=GIFEncoder,e.Decoder=t}();